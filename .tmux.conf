set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB"

set -g mouse on

set-window-option -g mode-keys vi

bind-key -T copy-mode-vi 'v' send -X begin-selection # start selecting text with "v"
bind-key -T copy-mode-vi 'y' send -X copy-pipe-and-cancel "wl-copy" # copy text with "y" to system clipboard
unbind -T copy-mode-vi MouseDragEnd1Pane
bind-key -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "wl-copy" # copy mouse selection to system clipboard

# Show pane numbers
set -g pane-border-status top
set -g pane-border-format "#P"

# Open new panes in current directory
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

# Window naming configuration
# Automatically rename windows based on the first pane's current directory
set-option -g automatic-rename off
set-option -g allow-rename on
set-option -g status-interval 1

# Hook that runs after various tmux events to update window name
# All hooks call the update script which gets first pane's directory
set-hook -g after-split-window 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'
set-hook -g after-new-window 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'
set-hook -g after-new-session 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'

# Update when switching panes or windows
set-hook -g pane-focus-in 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'
set-hook -g window-pane-changed 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'

# Also update when session is attached (to handle initial state)
set-hook -g client-attached 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'
set-hook -g client-session-changed 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'

# Update periodically to catch directory changes
set-hook -g alert-activity 'run-shell "/home/pofuk/magic-ide/update-tmux-window-name.sh"'

# Add a hook for prompt commands (requires shell integration)
# This ensures updates when changing directories
set-option -g focus-events on

# Shell integration for automatic window naming when navigating directories
# Add this line to your .bashrc or .zshrc for full integration:
# source /home/pofuk/magic-ide/tmux-shell-integration.sh
#
# This will ensure window names update immediately when you cd or navigate
# in any pane, always showing the basename of the first pane's directory

# Tmux plugins:
set -g @plugin 'tmux-plugins/tpm'                    # Tmux Plugin Manager
set -g @plugin 'tmux-plugins/tmux-sensible'          # Sensible tmux defaults
set -g @plugin 'christoomey/vim-tmux-navigator'      # Seamless navigation between vim and tmux splits
set -g @plugin 'catppuccin/tmux#v2.1.1'              # Catppuccin color theme for tmux

set -g @catppuccin_flavor "mocha"
set -g @catppuccin_window_status_style "rounded"


set -g status-position top
set -g status-right-length 200
set -g status-left-length 100
set -g status-left ""
set -g status-right "#{E:@catppuccin_status_session}"
set -g status on

set -g @catppuccin_window_current_text " #{b:window_name}"
set -g @catppuccin_window_text " #{b:window_name}"


# bind-key k display-popup -w 90% -h 80% -T opencode "zsh -lc 'exec /home/denis/.opencode/bin/opencode'"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'

